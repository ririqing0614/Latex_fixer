# Latex_fixer

这是一个基于 Python 的自动化工具，旨在解决 Word 文档中 LaTeX 源码（如 `$formula$`）无法正常显示的问题。它能将文档中的 LaTeX 代码批量转换为 Word 原生的 **Office Math (OMML)** 公式，使其可编辑且排版美观。

## 🌟 功能特性

* **离线转换**：内置离线逻辑，支持直接调用本地 `MML2OMML.XSL` 转换表，无需联网即可稳定处理。
* **全文档扫描**：自动遍历文档的正文段落以及表格（Table）中的所有内容。
* **智能识别**：支持行内公式 `$x^2$` 和独立块公式 `$$\frac{a}{b}$$`。
* **原生编辑**：转换后的公式为 Word 原生对象，而非图片，支持在 Word 中进行二次修改。
* **容错处理**：自动过滤 `$ $` 等空标记，遇到无法解析的复杂语法会保留原样，确保脚本不崩溃。

## 🛠️ 安装要求

在运行脚本之前，请确保已安装以下依赖库：

```bash
pip install python-docx latex2mathml lxml
```

## 🚀 使用指南

1. **准备转换表**：
   - 将 `MML2OMML.XSL` 文件放置在与 `latex_change.py` 相同的目录下。
   - *注：该文件通常可在 Office 安装目录（如 `C:\Program Files\Microsoft Office\root\Office16\`）中找到。*

2. **执行脚本**：
   ```bash
   python latex_change.py
   ```
3. **输入路径**：

* 根据提示输入需要处理的 `.docx` 文件完整路径。
* 设置输出文件路径（默认为 `原文件名_公式版.docx`）。

## 📝 适用场景示例

特别适用于数值分析作业或论文初稿，例如将以下内容自动修复：

* [cite_start]**输入文本**：已知 $f(x) = \ln x$，求在 $[0.4, 0.7]$ 上的插值。 [cite: 58-60]
* **输出结果**：Word 文档中 $\ln x$ 和 $[0.4, 0.7]$ 均显示为标准的 Office 数学公式。

## ⚠️ 注意事项

* **格式备份**：脚本在插入公式时会重构该段落，可能会导致段落内的特殊样式（如特定字体的颜色）重置，建议处理前备份原始文档。
* **环境说明**：本脚本已在 Linux 和 Windows 下测试通过。

## 📄 许可证

本项目采用 MIT 许可证。
